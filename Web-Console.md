# Cool things you can do with just the web console

Your Web-Browser has a powerful console which can be used for hacking. I'll show you some examples of things I find interesting to do with it.

## TL;DR

I'll just talk about the cool things you can do with just the web console without the target having no knowledge about what you are doing or discovering and then you can later write everything that would allow you to exploit what you'd have discovered. :smiling_imp:

## Introduction

Hi, I'm Jiab77 and known as Doctor Who in the [THC Telegram Channel](https://t.me/thcorg).

## Da web console

![image](https://user-images.githubusercontent.com/9881407/187093682-835a8015-c40b-4598-9c21-7ef311b47e79.png)

> Yes, I'm squating GitHub to store the images :metal:

To open the console, simply hit the `[F12]` key. It should work on every platforms and every browsers. You can also use `[Ctrl + Shift + I]` to open the web console.

## Best tabs to know

There are many tabs in the web console. The most useful ones for hacking are:

* __Elements__ - Shows the dynamic source code (includes the one generated by Javascript) and modify it locally
* __Console__ - Allows you to access to all websites and applications code but also inject some
* __Sources__ - Shows the source files of websites and applications
* __Network__ - Shows all the requests made by the websites and applications
* __Application__ - Shows all data stored by the websites and applications in the browser

### Elements

One of the simpliest thing that you can do with the __Elements__ tab is to reveal the passwors hidden by the dots:

* Normal password display

![image](https://user-images.githubusercontent.com/9881407/187094301-8bcee638-b793-4326-9674-70a4f2f33aff.png)

* Password revealed

![image](https://user-images.githubusercontent.com/9881407/187094363-d70d9b7c-5125-46e0-b51c-c7bd5186051a.png)

But you can do many things as you can edit any elements loaded in your browser. In this case, I just changed the element type from `password` to __`text`__. The result is that the Browser now shows any enter password instead of `*******`! :tada:

![image](https://user-images.githubusercontent.com/9881407/187094473-acbbf8f7-0bab-49f4-9276-08a4ea0a0365.png)

To revert it as password display, simply set the element type back to `password`:

![image](https://user-images.githubusercontent.com/9881407/187094507-a4a50a68-5b9a-4924-bb9d-302f5ba7d889.png)

### Console

To use this one, you'll have to know about Javascript programming. Without it, you'd not be able to do anything in the console tab but if you know it, then you can find some nice things that developpers stores in the global `window` context.

![image](https://user-images.githubusercontent.com/9881407/187094602-c2ae280f-635a-46c7-a62c-4d314a781d5d.png)

Simply type `window` then hit enter and expand the displayed object properties.

Here you can see few things that comes from the developer of the website I'm using for the screenshots, these are not part of the default `window` object content:

<!--
![image](https://user-images.githubusercontent.com/9881407/187094716-10835c22-87a5-4b26-b303-176fa6c794ec.png)

In the picture you can see the `getWidget`, `getXHR` and the property `i` that are part of the code stored in the global context.
-->

![image](https://user-images.githubusercontent.com/9881407/187095191-aa3b0265-85b3-46bc-87eb-ef7063b32ad2.png)

In the picture you can see the `__meteor_runtime_config__` object that contains some interesting things, for example some details about the Sentry tool used to diagnose issues in the code:

![image](https://user-images.githubusercontent.com/9881407/187095332-df62ed21-f9f2-4012-a20a-1cda430e9164.png)

So yeah nothing really juicy here but try it on different websites or applications that uses the browser, you'd be surprised :sweat_smile: I could find some application secrets stored loosely in the global context (_the `window` object_).

I said earlier that can also inject some code directly in the website, I'll show you a basic example:

![image](https://user-images.githubusercontent.com/9881407/187094953-0fe9e6d5-6812-4e47-9089-38f24c3933ef.png)

And the code injected from the console tab:

```js
window.alert('THC is the best hacking group!!');
```

It's just a basic example but if the website or the application is not protected against code injection with a `CSP` (_Content Security Policy_), you can basically inject everything you want, modify any elements in the page and so on.

### Sources

This one might sounds not really interesting but again you might be surprised by what some developers can leave in clear in their source files so don't hesitate to waste some hours digging into them, you might find some golden nuggets :wink:

![image](https://user-images.githubusercontent.com/9881407/187095378-81ed1eb5-9b2d-4c53-9385-c88e6a916f18.png)

To make the code more readable, click on the `{}` button at the bottom to get this:

![image](https://user-images.githubusercontent.com/9881407/187095413-2b6f868a-333c-43b5-ad15-2dafccdfdee7.png)

So yeah, again nothing really juicy here, it's just an example. I'll try to show some stuffs later that might be more interesting, just keep reading :grin:

### Network

This one is one of my favorite and I've discovered so many things with it just by observing and learning what data are exchanged on the websites and applications. This allowed me to discover and later exploit many weaknesses.

Here is a practical example from the website [speedlight.io](https://speedlight.io/my). They will give you a lifetime gold membership if you contact them with this code:

![image](https://user-images.githubusercontent.com/9881407/187095645-bf32d8cf-5d68-46cd-9313-0367a22df0c0.png)

So here the secret code is: `IFOUNDSECRET` :rofl:

> I know already that at least two persons already contacted them so it might left 8 places or less... (these two persons are me and a friend of mine :sweat_smile:)

Summary:

* Access URL: <https://speedlight.io/my>
* URL that contains the secret code: <https://widget.userpowered.io/init?uuid=[REDACTED]>

Honestly, this one was pretty easy to find but many ones will be in the `Fetch/XHR` sub tab and dynamic websites uses it a lot so finding good stuffs means analyzing a lot of requests... but you can find cool things when you get lucky. I'll show you later so keep reading :wink:

### Application

This one is the one that will often contain the most sensible details about you that the website or application will store to recognize you during your future visits.

![image](https://user-images.githubusercontent.com/9881407/187096191-4dadc2f6-ace0-4439-94a6-1b8d7ac0f716.png)

Everyone knows about cookies so I won't really go in details about them but more about the other storage types that you might not know about them:

* __Local Storage__ - Persistent storage limited to 5MB per domains or more depending on the victim browser (can be [abused](https://feross.org/fill-disk/))
* __Session Storage__ - Volatile storage, it's content will disappear once you close the tab or the browser
* __IndexedDB__ - Bigger persistent storage, it works just like a classical `SQL` database with some minor differences

You might have noticed that I've changed the content of the stored data in the __Local Storage__ section. You can basically modify every data stored in your browser, reload the page and see the result.

As I said, I won't go in details about __cookies__ but the cookie stealing technique is basically just noting somewhere the cookie of someone else, get back to your home, go on the same website and change your cookie value by the one you've stollen and you will be logged as the person you've stollen the cookie :sunglasses:

In this case, `speedlight.io` are not using the __cookies__ to store the session tokens, they deciced to use the __Local Storage__ to store them instead.

## Concrete use and discoveries

If you are still there, thanks a lot for your patience. :bow:

I'll now show you some concrete examples from some discoveries I've made on my side:

### hidden features in router interface of a Swiss internet provider

Initially, I just wanted to access to my router logs because as every routers that runs on Linux, they must have logs, right?! But I searched everywhere inside that damn router and could not find anything regarding the logs and after some digging and analysis of the `JS` files of the interface, I found one that has some interesting constants:

![image](https://user-images.githubusercontent.com/9881407/187303356-885868eb-2b84-4993-9197-150f277f008e.png)

```js
var MENU_LVL=0;
var MENU_TITL=1;
var MENU_NAME=2;
var MENU_URL=3;
var MENU_ON=4;
var MENU_TARGET=5;
var MENU_GRP=6;
var MENU_ELM=7;
var MENU_USER=5;
var MENU_EXP=7;
var MENU_SUPER=10;
```

Then I've analyzed the `HTML` source of the user mode selector and found something that could linked to these constants:

![image](https://user-images.githubusercontent.com/9881407/187303684-effbda41-bfa9-435b-b61d-0a86f7e9dc5e.png)

The selector code is the following:

![image](https://user-images.githubusercontent.com/9881407/187303803-edfd3da6-a87c-4a28-873b-52519fc344a4.png)

So, what do we have here?

* Standard = `MENU_USER=5`

  ![image](https://user-images.githubusercontent.com/9881407/187303684-effbda41-bfa9-435b-b61d-0a86f7e9dc5e.png)

* Expert = `MENU_EXP=7`

  ![image](https://user-images.githubusercontent.com/9881407/187304586-a72f3c51-53a7-4d1c-a398-01b33ff556e1.png)

  > Interesting, no? And what if I change the value of the radio input from `7` to __`10`__ before clicking on it? Will it show something cool? Yeah, baby! :grin:

* Super User (hidden) = `MENU_SUPER=10` (_sounds logical, right?_)

  ![image](https://user-images.githubusercontent.com/9881407/187304763-acbea7e8-ba17-4258-a01f-7c6ad976610f.png)

  > Yesss, finaly a `Log` tab!!

Let's see what we can find in this `Log` tab!

![image](https://user-images.githubusercontent.com/9881407/187305241-617aec01-95cf-43be-adcf-32cf7a998330.png)

WTF?! Are you kidding me? :unamused:

Let's have a look at the web console to see what we got:

![image](https://user-images.githubusercontent.com/9881407/187305538-20220cd5-226c-4da6-9bb6-d028f1b6086d.png)

Damn it... :expressionless:

> Long story short, I must configure my local network connection to be in the right `VLAN` to be able to display the hidden content... It sucks :sweat_smile:

Anyway, a side of this simple thing, it was one of my biggest discoveries in terms of possible impact as I haven't just found that but many other things that I won't detail here.

### tunein.com

What I'll show here is mostly valid for any web radios whatever they ask you to pay something each months to get it or not:

* Open up the web console
* Go to the __Network__ tab
* Filter by `pls`, `hls`, `m3u`

![image](https://user-images.githubusercontent.com/9881407/187097289-133d61c2-1efa-418f-9050-62f33f919791.png)

And enjoy the direct streaming URL that you can later play in __VLC__ for example:

* URL: <https://hydra.shoutca.st:2199/tunein/tunitup2020.pls>
* Example with __VLC__:

![image](https://user-images.githubusercontent.com/9881407/187097367-33205a11-abba-4880-82b6-b3b7b10dc040.png)

* Example with `ffplay`:

![image](https://user-images.githubusercontent.com/9881407/187097589-46f589e2-36ff-4162-82d8-e1946e0edbfe.png)

> The executed command was: `ffplay "http://148.251.43.149:8321/stream"`
>
> This address has been found in the logs from __VLC__.
>
> ![image](https://user-images.githubusercontent.com/9881407/187097701-2bb9d853-4dd7-429c-b5bc-1689c8fd2234.png)

Basically, most streaming servers based on `shoutcast` or `icecast` does not support the `HTTPS` protocol so they are using `HTTP` only most of the time...

### secondlife.com

![image](https://user-images.githubusercontent.com/9881407/187096450-458fd154-8087-48ae-9784-a9067c48cccd.png)

If you can get your hands on the `session-token` of a Second Life user, just connect on the [website](https://secondlife.com/my/index.php), replace the generated `session-token` by the one you could catch and reload the page, you'll be logged in.

Basically, if the user as not logged off, the `session-token` will be valid for around 15 days until it gets revoked.

Another weakness I can tell for those who likes to crack passwords:

* Max password size: 16 chars
* Limited amount of special chars supported

I've pasted this:

```
{÷=.3y};_lo:(7l{yy<Fz2n((lK.>ÌF+"7¥:±a65]@w¹à@~}&[nI)55(Vl{)zU"{14O£5`7A[NJ`6F}6>{n^Vlâ!J6dSÆg<W83*I}"Õ6bo=àÇO<>6m1bA2wV3êl[ÕOg6
```

And only this was stored in the password field:

```
{÷=.3y};_lo:(7l{
```

Was it accepted? Yes but it's quite short :cry:

> Don't try to pass `ANSI` chars they won't be accepted :laughing:

### stripchat.com

This one will be probably the most interesting for you :stuck_out_tongue_winking_eye: as they clearly don't give a fuck about security or they just don't know how to put it in place correctly or whatever but their weakness are quite obsvious and [easy](https://github.com/DgSe95/porn-proxyfy) to [exploit](https://github.com/DgSe95/porn-dump-cli).

#### Connected models

* Open up the web console
* Go to the __Network__ tab
* Select the `Fetch/XHR` sub tab

![image](https://user-images.githubusercontent.com/9881407/187097932-99244017-5728-4e2e-b630-48e8c5fd8187.png)

* Change the URL from:
  * <https://stripchat.com/api/front/v2/models?limit=24&topLimit=61&favoritesLimit=24&primaryTag=girls&device=desktop&uniq=ingyts30bj1qc6da>
* To:
  * <https://stripchat.com/api/front/v2/models?limit=10000>

Now enjoy :grin:, you have the details about the `4512` connected models at that time :rofl:

#### WebRTC servers credentials

If you take the URL from the previous section and do the following:

* From: <https://stripchat.com/api/front/v2/models?limit=10000>
* To: <https://stripchat.com/api/front/v2/config>

You'll get the complete website config in `JSON` and this include something juicy:

```json
"webRTCOriginTurnServersPortMap":{"servers":[]},"webRTCTurnServersConfig":{"servers":["eu11","eu14","as1","as2","eu1","eu2","eu3","eu4","eu5","eu6","eu7","eu8","eu9","eu10","eu11","eu12","eu13","eu14","eu15","eu16","eu17","eu18","eu19","eu20","eu21","eu22","eu23","eu24","eu25","eu26","eu27","eu28","as1","as2","as3","as4","as5","as6","as7","as8","as9","as10","us1","us2","us3","us4","us5","us6","us7","us8","us9","us10","us11","us12","us13","us14","us15","us16","us17","us18","us19","us20","us21","us22","us23","us24","us25","us26","us27","us28"],"iceServersTemplate":{"iceServers":[{"url":"turn:b-{server}.stripcdn.com:2083?transport=udp","username":"johndoe","credential":"j8Hkl0UYqwW4r"},{"url":"turn:b-{server}.stripcdn.com:2083?transport=tcp","username":"johndoe","credential":"j8Hkl0UYqwW4r"}],"iceTransportPolicy":"relay"}}
```

More precisely:

```json
"username":"johndoe","credential":"j8Hkl0UYqwW4r"
```

So if you reconstruct the data from just the `WebRTC` servers part you get more than 40 servers with the same credentials applied to them:

* From:
  * `turn:b-{server}.stripcdn.com:2083?transport=udp`
  * `turn:b-{server}.stripcdn.com:2083?transport=tcp`
* To:
  * `turn:b-eu11.stripcdn.com:2083?transport=udp`
  * `turn:b-eu11.stripcdn.com:2083?transport=tcp`

And so on :grin:

If you combine them with [turner](https://github.com/staaldraad/turner)... It will gives you the same amount of web proxies that you can use to hide your trafic behind the stripchat servers :smiling_imp:

#### Live streams recording

* Click on any model stream
* Disable the low latency mode (_toggle this: :zap: off_)
* Open up the web console
* Go to the __Network__ tab
* Filter with `m3u8`

![image](https://user-images.githubusercontent.com/9881407/187098704-c783d09b-2642-4937-bf14-0b3f0a45415f.png)

Here the interesting URL is:

* <https://b-hls-19.doppiocdn.com/hls/17085196/master/17085196_auto.m3u8>

This is the direct stream URL of the model that you can play in __VLC__ or `ffplay` but not just that, you can also record it and/or restream it with `ffmpeg`.

```
$ ffplay -hide_banner "https://b-hls-19.doppiocdn.com/hls/17085196/master/17085196_auto.m3u8"
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-VERSION:6')B sq=    0B f=0/0   
[hls @ 0x7fb624000bc0] Opening 'https://b-hls-16.doppiocdn.com/hls/17085196/17085196_160p.m3u8' for reading
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-VERSION:6')B sq=    0B f=0/0   
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-INDEPENDENT-SEGMENTS')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-DISCONTINUITY-SEQUENCE:2')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:38.407+0000')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:40.385+0000')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:42.411+0000')
[https @ 0x7fb624015980] Opening 'https://b-hls-16.doppiocdn.com/hls/17085196/17085196_240p.m3u8' for reading
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-VERSION:6')B sq=    0B f=0/0   
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-INDEPENDENT-SEGMENTS')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-DISCONTINUITY-SEQUENCE:2')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:36.257+0000')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:38.317+0000')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:40.323+0000')
[https @ 0x7fb624015980] Opening 'https://b-hls-16.doppiocdn.com/hls/17085196/17085196_480p.m3u8' for reading
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-VERSION:6')B sq=    0B f=0/0   
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-INDEPENDENT-SEGMENTS')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-DISCONTINUITY-SEQUENCE:2')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:36.288+0000')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:38.247+0000')
[hls @ 0x7fb624000bc0] Skip ('#EXT-X-PROGRAM-DATE-TIME:2022-08-28T23:22:40.300+0000')
```

> Nope, I won't show you nice pictures of the captured stream :rofl:

I won't go in detail about it as it will be quite off topic but maybe in another wiki article :stuck_out_tongue_winking_eye:

## Extra

### Use GitHub as picture storage

As you might have probably seen, all the pictures in this document are stored in GitHub but they normally don't offer that feature. :sweat_smile:

It's very simple:

1. Create a new issue in any project (_no need to submit it_)
2. Make a screenshot of the image you like to upload. This will load the image into memory.
3. Paste it in the `textarea` field of the new issue. GitHub will convert and store the image at a permanent URL:

    ![image](https://user-images.githubusercontent.com/9881407/187099344-330a0413-a8df-4c9a-b501-a5eaf578a215.png)

4. Copy the generated URL and paste it wherever you want :wink:

> It's in the `markdown` format but you can easily extract the URL between the `()` to get the direct picture link only.

## Thanks

Please share your thougths in the [Telegram Channel](https://t.me/thcorg) :stuck_out_tongue_closed_eyes:

## Research

If you are curious and want to see more about what I discovered, you can find more details here:

* <https://gist.github.com/Jiab77/6c38f6566d68784f4591b60c0269a8f0>
* <https://github.com/DgSe95/stream-capture-poc>

## References

* <https://developer.mozilla.org/en-US/docs/Web/API/console>
* <https://developers.google.com/web/tools/chrome-devtools/console/console-reference>
* <https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API>
* <https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API>
* <https://feross.org/fill-disk/>
* <https://github.com/staaldraad/turner>

## Author

* On Telegram: Doctor Who
* On Twitter: Jiab77
* Sometimes...:smiling_imp:: DgS95
